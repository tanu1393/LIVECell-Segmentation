
# Cell Segmentation Using U-Net

## Overview
This project utilizes U-Net, a popular convolutional neural network (CNN) architecture, for segmenting biological cell images. 
The goal is to accurately segment cell regions from microscopy images. The implementation involves several steps including data preparation, model training, and evaluation using the LIVECell dataset.

## Benefits of Using U-Net for Cell Segmentation
- **High Accuracy**: U-Net's skip connections preserve high-resolution features, leading to precise segmentation boundaries.
- **Scalability**: The architecture can handle both 2D and 3D biomedical images.
- **Extensibility**: U-Net has numerous extensions and enhancements that can be integrated based on specific task requirements.

## Steps

### 1. Data Preparation
The dataset used for this project is the LIVECell dataset, which consists of labeled images for cell segmentation. The data processing steps include:

- **Downloading the Dataset**: We begin by downloading the dataset, which includes both images and their annotations (segmentation masks).
- **Data Structure**: The dataset is organized into training, validation, and testing sets. The images and corresponding segmentation masks are stored separately. Masks are created based on the annotations provided in the dataset.
- **Mask Generation**: The segmentation masks are generated by converting the polygon annotations into binary masks. This is done using OpenCV to draw polygons based on the segmentation coordinates.
- **Splitting Dataset**: The images are separated into different directories for training, validation, and testing. The respective segmentation masks are also moved to corresponding directories.

### 2. Data Augmentation and Preprocessing
To improve the modelâ€™s generalization ability, data augmentation is applied to the training images. The augmentation techniques include:

- Resizing images to a fixed size (1024x1024).
- Normalizing pixel values using mean and standard deviation values from ImageNet.
- Converting images and masks to PyTorch tensors for efficient processing.

### 3. U-Net Model
The core of this approach is the U-Net architecture, which is used for image segmentation tasks. The U-Net model has the following key components:

- **Encoder**: A series of convolutional layers that extract features from the input image.
- **Decoder**: A series of upsampling layers that reconstruct the image with segmentation boundaries.
- **Skip Connections**: These connect the encoder and decoder at corresponding levels, preserving spatial features that are essential for precise segmentation.

The U-Net model is implemented using the `segmentation-models-pytorch` library, with a ResNet backbone for the encoder. The model is configured with a sigmoid activation function, suitable for binary segmentation tasks.

### 4. Training the Model
The model is trained using the following steps:

- **Loss Function**: Cross-Entropy Loss is used to train the model. 
- **Optimizer**: The AdamW optimizer is used, which adapts learning rates for each parameter and helps with training stability.
- **Learning Rate Scheduler**: A Cosine Annealing scheduler adjusts the learning rate during training to improve convergence.

### 5. Model Evaluation
The model is evaluated based on its performance on the validation and test datasets. The Dice coefficient and loss values are monitored throughout training to ensure the model is learning effectively.

### 6. Saving and Loading the Model
The best performing model is saved after training, and it can be loaded for inference on new data. The trained model is also available for further fine-tuning if needed.

### 7. Inference
Once the model is trained, it can be used for segmentation of unseen test images. The model predicts the segmentation mask for a given input image, which can be compared against the ground truth to evaluate the performance.

## Installation
To install the required dependencies, run the following command:

```bash
pip install requirements.txt
```

## File Structure
```bash
/Dataset
    /images
        /livecell_train_images
        /livecell_val_images
        /livecell_test_images
    /annotations
        livecell_coco_train.json
        livecell_coco_val.json
        livecell_coco_test.json
    /masks
        /train
        /val
        /test
```

## Running the Code
Run the trainingUNET.ipynb file

## References
- Ronneberger, O., Fischer, P., & Brox, T. (2015). U-Net: Convolutional Networks for Biomedical Image Segmentation. arXiv:1505.04597.
- LIVECell Dataset: LIVECell dataset website.
